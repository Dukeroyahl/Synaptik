# Synaptik MCP Server Configuration  
# Native executable for stdio MCP, calling Docker server on port 9001

# Disable HTTP server (stdio-only native executable)
quarkus.http.port=0

# MCP stdio configuration  
quarkus.mcp.server.stdio.enabled=true

# Logging configuration - FILE ONLY for stdio mode
# Console logging DISABLED to avoid interfering with JSON-RPC protocol
quarkus.log.level=INFO
quarkus.log.console.enable=false
quarkus.log.file.enable=true
quarkus.log.file.path=${user.home}/.synaptik/logs/mcp-server.log
quarkus.log.file.level=DEBUG
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=5

# Category-specific logging levels for debugging
quarkus.log.category."org.dukeroyahl.synaptik".level=DEBUG
quarkus.log.category."io.quarkiverse.mcp".level=DEBUG
quarkus.log.category."io.quarkus.rest.client".level=DEBUG
quarkus.log.category."jakarta.ws.rs".level=DEBUG

# Synaptik API connection (Docker server)
# Default to localhost:9001, but allow override via environment variable
synaptik.api.base-url=${SYNAPTIK_API_URL:${SYNAPTIK_URL:http://localhost:9001}}

# REST client configuration
quarkus.rest-client."synaptik-api".url=${SYNAPTIK_API_URL:${SYNAPTIK_URL:http://localhost:9001}}
quarkus.rest-client."synaptik-api".scope=jakarta.inject.Singleton

# Native compilation settings - enhanced for MCP reflection
%native.quarkus.native.additional-build-args=--verbose,--initialize-at-build-time=org.dukeroyahl.synaptik.mcp.SynaptikMcpServer,--trace-class-initialization=org.dukeroyahl.synaptik.mcp.SynaptikMcpServer

# Force inclusion of runtime annotations  
%native.quarkus.native.enable-all-security-services=false
%native.quarkus.native.enable-reports=true

# Container build for Apple Silicon (recommended for distribution)
%native.quarkus.native.container-build=true
%native.quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21-mandrel-24.0.0

# Platform-specific container images
%darwin-arm64.quarkus.native.container-build=true
%darwin-arm64.quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21-mandrel-24.0.0
%linux-amd64.quarkus.native.container-build=true
%linux-amd64.quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21-mandrel-24.0.0
